jQuery(document).ready(function(c){var b={};c("body").on("click",".add-term-thumbnail",function a(g){var f=c(this).parent(".thumbnail-field-wrapper").attr("id").slice(0,-14);window.wpActiveEditor=f;if(typeof(b[f])!=="undefined"){b[f].open();return}b[f]=window.wp.media.frames.file_frame=window.wp.media({title:window.sftth.chooseImage,button:{text:window.sftth.selectImage},library:{type:"image"},multiple:false});b[f].on("open",function d(){var e=Number(document.getElementById(f).value),j,i;if(!e){return}j=wp.media.attachment(e);if(!j){return}j.fetch();i=b[f].state().get("selection");i.add([j])});b[f].on("select",function h(){var m=b[f].state().get("selection").first().toJSON(),k=document.getElementById(f),l=c("#"+f+"-field-wrapper"),e=l.data("tt-id"),j=c("<img />"),i;k.value=m.id;if(typeof(m.sizes.medium)==="object"){j.attr({src:m.sizes.medium.url,height:m.sizes.medium.height,width:m.sizes.medium.width,"class":"attachment-thumbnail"});i=m.sizes.medium.orientation}else{if(typeof(m.sizes.thumbnail)==="object"){j.attr({src:m.sizes.thumbnail.url,height:m.sizes.thumbnail.height,width:m.sizes.thumbnail.width,"class":"attachment-thumbnail"});i=m.sizes.thumbnail.orientation}else{j.attr({src:m.url,height:m.height,width:m.width,"class":"attachment-full"});i=m.orientation}}j.attr({alt:m.alt,title:m.title});j=j.wrap('<button type="button" class="change-term-thumbnail add-term-thumbnail attachment" id="thumbnail-button" title="'+window.sftth.changeImage+'"><span class="attachment-preview type-image"><span class="thumbnail"><span class="centered"></span></span></span></button>').parents(".attachment-preview").addClass(i).parents(".change-term-thumbnail");l.text("").append(j).append("<br/>").append('<button type="button" class="remove-term-thumbnail button button-secondary button-large delete">'+window.sftth.removeImage+"</button>");if(typeof e!=="undefined"&&e){l.find(".add-term-thumbnail").attr({disabled:"disabled","aria-disabled":"true",title:window.sftth.loading}).focus().siblings(".remove-term-thumbnail").after('<span class="spinner is-active"></span>');wp.media.ajax("set-term-thumbnail",{data:{id:m.id,tt_ID:Number(e),term_ID:c('[name="tag_ID"]').val(),taxonomy:c('[name="taxonomy"]').val(),_wpnonce:document.getElementById("_wpnonce").value}}).done(function(){l.find(".add-term-thumbnail").removeAttr("disabled aria-disabled").attr("title",window.sftth.changeImage).siblings(".spinner").replaceWith('<span class="dashicons dashicons-yes"></span><input type="hidden" name="term-thumbnail-updated" value="1" />');if(wp.a11y&&wp.a11y.speak){wp.a11y.speak(window.sftth.successSet)}}).fail(function(){l.find(".add-term-thumbnail").removeAttr("disabled aria-disabled").attr("title",window.sftth.changeImage).siblings(".spinner").replaceWith('<div class="error-message">'+window.sftth.errorSet+"</div>");if(wp.a11y&&wp.a11y.speak){wp.a11y.speak(window.sftth.errorSet)}})}});b[f].open()});c("body").on("click",".remove-term-thumbnail",function a(h){var f=c(this).parent(".thumbnail-field-wrapper").attr("id").slice(0,-14),g=c("#"+f+"-field-wrapper"),d=g.data("tt-id");document.getElementById(f).value="";g.text("").append('<button type="button" class="add-term-thumbnail button button-secondary button-large" id="thumbnail-button">'+window.sftth.setImage+"</button>");if(typeof d!=="undefined"&&d){g.find(".add-term-thumbnail").attr({disabled:"disabled","aria-disabled":"true",title:window.sftth.loading}).focus().after('<span class="spinner is-active"></span>');wp.media.ajax("delete-term-thumbnail",{data:{tt_ID:Number(d),term_ID:c('[name="tag_ID"]').val(),taxonomy:c('[name="taxonomy"]').val(),_wpnonce:document.getElementById("_wpnonce").value}}).done(function(){g.find(".add-term-thumbnail").removeAttr("disabled aria-disabled").attr("title",window.sftth.changeImage).siblings(".spinner").replaceWith('<span class="dashicons dashicons-yes"></span><input type="hidden" name="term-thumbnail-updated" value="1" />');if(wp.a11y&&wp.a11y.speak){wp.a11y.speak(window.sftth.successRemoved)}}).fail(function(){g.find(".add-term-thumbnail").removeAttr("disabled aria-disabled title").siblings(".spinner").replaceWith('<div class="error-message">'+window.sftth.errorRemoved+"</div>");if(wp.a11y&&wp.a11y.speak){wp.a11y.speak(window.sftth.errorRemoved)}})}});c('[for="thumbnail"]').attr("for","thumbnail-button");c(".wp-thumbnail-wrap").attr("aria-hidden","true");c(".thumbnail-field-wrapper").removeAttr("aria-hidden");c(".add-term-thumbnail, .remove-term-thumbnail").after('<input type="hidden" name="term-thumbnail-updated" value="1" />');if(c("#addtag").length){c.ajaxPrefilter(function(d){var e="&"+d.data+"&";if(e.indexOf("&action=add-tag&")!==-1){c(".remove-term-thumbnail").click()}})}});